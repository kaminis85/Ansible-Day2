---
# Variable file for Trident protect related tasks
# Used in roles/trident-protect/trident-protect-common/tasks/main.yml
# Used in roles/trident-protect/backup_and_restore_scenario/tasks/main.yml
# Used in roles/trident-protect/snapshot_and_restore_scenario/tasks/main.yml

# ONTAP S3 credentials and configuration related variables
s3_access_key: "your-s3-access-key"           # Replace with your ONTAP S3 access key
s3_secret_key: "your-s3-secret-key"           # Replace with your ONTAP S3 secret key
ontap_s3_bucket_name: "your-s3-bucket-name"   # Replace with your ONTAP S3 bucket name
ontap_s3_endpoint: "your-ontap-s3-endpoint"   # Single S3 LIF IP or FQDN (round robin DNS with multiple S3 LIF entries for load balancing)
                                              # Examples: "10.102.2.53" or "aa02-ocp-s3-lif.aa02-ocp.flexpodb4.cisco.com"

# AppVault secret name
appvault_secret_name: "appvault-secret"       # Name of the Kubernetes Secret for AppVault

# Trident protect AppVault name
appvault_name: "ontap-s3-appvault"            # Name of the Trident protect AppVault

# Namespace where VMs are deployed in OpenShift Virtualization
vm_namespace: "demo"                          # Namespace containing the VMs to be backed up or snapshotted

# VMs and associated resources related variables
# Note: Ensure that the VM names and PVC names match with those in your OpenShift Virtualization environment
vm_list:
  - "demo-rhel9"             # List of VMs to be backed up or snapshotted
  - "demo-windows2k25"

pvc_list:
  - "demo-rhel9-pvc"         # List of PVCs associated with the VMs
  - "demo-windows2k25-pvc"

# Label to be applied to VMs and associated resources for selection during backup or snapshot
vm_label: "protect-rhel-win2k25-vms"          # Label to identify VMs & associated resources for backup/snapshot

# Application for VMs [Managed with Trident protect]
# Note: Application should be created in the same namespace as the VMs
application_name: "demo-vms-app"                  # Application name for the VMs

## On-demand Backup and Restore related variables
on_demand_backup_name: "demo-vms-backup-on-demand"  # Name of the on-demand backup

# Restore namespace
restore_namespace: "demo2"                          # Namespace to which VMs will be restored

# BackupRestore object name
backuprestore_name: "demo2-vms-restore-from-backup"            # Name of the BackupRestore object used for restoration

## Scheduled Snapshot and Restore related variables
# Note: Snapshot schedules will be created in the same namespace as the VMs

# Snapshot schedule specifications
snapshot_schedule_name: "demo-vms-snapshot-schedule"       # Name of the snapshot schedule
snapshot_retention_count: "2"                              # Number of snapshots to retain
snapshot_granularity: "Hourly"                             # Granularity of snapshots (e.g., Hourly, Daily, Weekly, Monthly)
snapshot_hour: ""                                          # Hour of the day for Daily/Weekly/Monthly snapshots (0-23)
snapshot_minute: "50"                                      # Minute of the hour for snapshots (0-59)
snapshot_day_of_month: ""                                  # Day of the month for Monthly snapshots (1-28/29/30/31)
snapshot_day_of_week: ""                                   # Day of the week for Weekly snapshots (0=Sunday to 6=Saturday)

# SnapshotInplaceRestore object name
snapshotinplacerestore_name: "demo-vms-restore-from-snapshot"  # Name of the SnapshotInplaceRestore object used for restoration

# VM Replication using NetApp SnapMirror and Trident protect related variables

# Source ONTAP S3 credentials and configuration related variables
src_ontap_s3_specs:
  secret_name: "src-appvault-secret"        # Kubernetes Secret name for source ONTAP S3 credentials
  access_key: "src-s3-access-key"           # Source ONTAP S3 access key
  secret_key: "src-s3-secret-key"           # Source ONTAP S3 secret key
  s3_bucket_name: "src-s3-bucket-name"         # Source ONTAP S3 bucket name
  s3_endpoint: "src-s3-endpoint"      # Source ONTAP S3 endpoint. Provide LIF for S3 access

# AppVault for source VM
src_appvault_name: "src-ontap-s3-appvault"    # Trident protect AppVault name for source VM

# Source VMs namespace
src_vm_namespace: "demo-src"            # Namespace where source VMs are deployed

# Source VMs to be replicated
# Note: Ensure that the source VM names and PVC names match with those in your OpenShift Virtualization environment
# Make sure to list critical VMs first to ensure proper replication order
src_vm_list:
  - "demo-rhel9-src"             # List of source VMs to be replicated
  - "demo-windows2k25-src"
  - "demo-ubuntu22-src"

# PVCs associated with source VMs
src_pvc_list:
  - "demo-rhel9-src-pvc"         # List of PVCs associated with source VMs
  - "demo-windows2k25-src-pvc"
  - "demo-ubuntu22-src-pvc"

# Label to be applied to source VMs and associated resources for selection during replication
src_vm_label: "replicate-src-vms"    # Label to identify source VMs & associated resources for replication

# Source application name for VMs in source namespace (source OpenShift cluster)
src_application_name: "demo-src-vms-app"    # Application name for source VMs

# If doing on-demand snapshot, set the below variable to true
on_demand_src_snapshot: false                 # Set to true to perform on-demand snapshot for source VMs before replication

# On-demand snapshot name for source VMs [Required for replication if on_demand_src_snapshot is true]
src_on_demand_snapshot_specs:
  name: "demo-src-vms-on-demand-snapshot"      # Name of the on-demand snapshot for source VMs
  reclaim_policy: "Retain"                     # Reclaim policy for the on-demand snapshot (e.g., Retain, Delete)

# If doing scheduled snapshot, set the below variable to true
scheduled_src_snapshot: true                  # Set to true to perform scheduled snapshots for source VMs before replication

# Snapshot schedule specifications for source VMs [Required for replication if scheduled_src_snapshot is true]
src_snapshot_schedule_specs:
  name: "demo-src-vms-snapshot-schedule"        # Name of the snapshot schedule for source VMs
  retention_count: 2                            # Number of snapshots to retain for source VMs
  recurrence_rule: {dtstart: "20251030T120000Z", rrule: "FREQ=MINUTELY;INTERVAL=5"}  # Recurrence rule for source VM snapshots. Example: Every 5 minutes starting from Oct 17, 2025, 00:02 UTC
# Note: Adjust dtstart and rrule as per your requirements
# Example dtstart format:
# dtstart: "20251024T143000Z"      # UTC time
# dtstart: "20251024T143000"       # Local time
# dtstart: "2025-10-24T14:30:00Z"  # UTC time
# dtstart: "2025-10-24T14:30:00"  # Local time (no timezone)
# Example rrule formats:
# rrule: "FREQ=MINUTELY;INTERVAL=10"   # Every 10 minutes
# rrule: "FREQ=HOURLY;INTERVAL=1"      # Every hour
# rrule: "FREQ=DAILY;INTERVAL=1"       # Every day
# rrule: "FREQ=WEEKLY;BYDAY=MO,WE,FR"  # Every Monday, Wednesday, and Friday
# rrule: "FREQ=MONTHLY;BYMONTHDAY=1"   # First day of every month
# rrule: "FREQ=YEARLY;BYMONTH=1;BYMONTHDAY=1" # Every January 1st
# Note: Refer to RFC 5545 for more rrule options

# Variables required for setting up replication to destination OpenShift cluster

dst_kubeconfig_path: dst-kubeconfig.txt   # Path to kubeconfig file for destination OpenShift cluster

# Destination ONTAP S3 credentials and configuration related variables
dst_ontap_s3_specs:
  secret_name: "dst-appvault-secret"          # Kubernetes Secret name for destination ONTAP S3 credentials
  access_key: "dst-s3-access-key"             # Destination ONTAP S3 access key
  secret_key: "dst-s3-secret-key"             # Destination ONTAP S3 secret key
  s3_bucket_name: "dst-s3-bucket-name"        # Destination ONTAP S3 bucket name
  s3_endpoint: "dst-s3-endpoint"              # Destination ONTAP S3 endpoint. Provide LIF for S3 access

# Destination AppVault for the destination application on the destination OpenShift cluster
dst_appvault_name: "dst-ontap-s3-appvault"    # Trident protect AppVault name for destination application

# Destination VMs namespace
dst_vm_namespace: "demo-dst"            # Namespace where destination VMs will reside

# AppMirrorRelationship specifications
app_mirror_relationship_specs:
  name: "demo-amr"                     # Name of the AppMirrorRelationship object for VM replication from source to destination
  storage_class: "ontap-nfs-sc"        # Storage class to be used for replicated VMs on destination cluster
  recurrence_rule: {dtstart: "20251030T120000Z", rrule: "FREQ=MINUTELY;INTERVAL=10"}  # Recurrence rule for replication. Example: Every 10 minutes starting from Oct 30, 2025, 12:00 UTC
# Note: Adjust dtstart and rrule as per your requirements